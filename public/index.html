<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Index</title>
		
		

		<link rel="shortcut icon" href="favicon.ico" />

		<!-- jQuery for bootstrap. -->
		<script 
			 src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js">
		</script>

		<!-- Center ads on ready. -->
		<script type="text/javascript">
			$(document).ready(function() {
			if (window.innerWidth > 800) {
			$(".centerad").css({"width": "728px"});
			} else {
			$(".centerad").css({"width": "320px"});
			}
			});
		</script>

		<!-- These are the style sheets for syntax highlighting. -->
		<link type="text/css" rel="stylesheet" 
					href="rainbow/css/github.css"/>

		<!-- Twitter Bootstrap. -->
		<link href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/css/bootstrap-combined.min.css" rel="stylesheet">

		<!-- Our own CSS. -->
		<style>
			body {
			/* 60px to make the container go all the way to the bottom of the
			topbar */
			padding-top: 60px; 
			}

			footer {
			text-align: center;
			font-size: small;
			}

			.float-right {
			float: right;
			padding: 5px;
			}

			.centerad {
			margin-left: auto;
			margin-right: auto;
			}
		</style
			 </head>
	<body>
		<div class="container">

			<!-- This is the top navigation bar. -->
			<div class="navbar navbar-inverse navbar-fixed-top">
				<div class="navbar-inner">
					<div class="container">
						<a class="btn btn-navbar" data-toggle="collapse" 
							 data-target=".nav-collapse">
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</a>
						<a class="brand" href="index.html">
							Non Impediti Ratione Cogitationis
						</a>
						<div class="nav-collapse collapse">
							<ul class="nav">
								<li class="active">
									<a href="index.html">
										<i class="icon-home icon-white"></i>
										Home
									</a>
								</li>
								<li >
									<a href="tags.html">
										<i class="icon-tag icon-white"></i>
										Tags
									</a>
								</li>
								<li >
									<a href="archives.html">
										<i class="icon-hdd icon-white"></i>
										Archives
									</a>
								</li>
								<li >
									<a href="about.html">
										<i class="icon-user icon-white"></i>
										About
									</a>
								</li>
							</ul>
						</div><!--/.nav-collapse -->
					</div>
				</div>
			</div>

			
<div class="row">
	<div class="span12">
		
		<h1>Colds, Static Blogs, and Go</h1>
		

		<p>
			<small id="entry-date">
				2013-01-29
			</small>
		</p>

		<!-- Title: Colds, Static Blogs, and Go -->

<!-- Author: Joshua Marsh -->

<!-- Tags: go,blog,html -->

<!-- Languages: shell -->

<p>Last week in my <a href="http://plug.org/">local Linux user group</a> mailing
list the topic of static blogging came up. I had been thinking of
converting my blog over, but wasn&rsquo;t sure which one I&rsquo;d prefer to
use. One of the responses to my inquiry was:</p>

<blockquote>
<p>If you&rsquo;ve been looking for a project with which to learn a new
language, writing your own blog engine is a reasonable choice.  The
&lsquo;market&rsquo; is already hopelessly polluted with toy blog engines, which
is evidence for its suitability as a learning project.  Most of what
makes a blog memorable has absolutely nothing to do with the
back-end software, anyway.  If you are feeling ambitious, you could
write a blog engine <em>and</em> your own Markdown parser with custom
extensions
(<a href="http://plug.org/pipermail/plug/2013-January/029154.html">Pearson, 2013</a>).</p>
</blockquote>

<p>I don&rsquo;t normally find myself with much time on my hands. I have two
young children, school, a full-time job, and now a sister-in-law with
crutches in the home. Misfortune (or fortune I suppose) befell me this
weekend though and my son gave me a terrible cold. I was out of
commission for the entire weekend.</p>

<p>You can only watch so much
<a href="http://www.usanetwork.com/series/psych/">Psych</a> and
<a href="http://www.pbs.org/wgbh/masterpiece/downtonabbey/">Downton Abbey</a>, so
I took upon myself the challenge of writing my own static blog
application as suggested. Without further guilding the lilies, here
it is: <a href="https://github.com/icub3d/goblog">goblog</a>.</p>

<p>I&rsquo;m so daring, that I&rsquo;ve even used it already to convert my existing
blog at blogger into a static blog and I&rsquo;ve hosted it using
appengine. If you are reading this, I can say that the software
worked! What&rsquo;s nice about this all is that it&rsquo;s still
free. <a href="https://github.com">Github</a> can host the code and I don&rsquo;t
imagine myself exceeding the free limits of
<a href="https://developers.google.com/appengine/">appengine</a>.</p>

<p>It is certainly rough around the edges, but I was surprised what I
could accomplish over a weekend while heavily medicated. I attribute a
lot of the success to the tools already available to me. Go provides a
<a href="http://golang.org/pkg/text/template/">template package</a> and
<a href="https://github.com/russross/blackfriday">Russ Ross</a> already had a
<a href="http://daringfireball.net/projects/markdown/">markdown</a> parser. The
front-end is simply <a href="http://twitter.github.com/bootstrap/">bootstrap</a>,
<a href="http://jquery.com/">jquery</a>, and
<a href="http://craig.is/making/rainbows">rainbow</a>. It was merely a matter
putting the pieces together.</p>

<p>You can see a completed working example with my own
<a href="http://joshua.themarshians.com/">blog</a> which originates from a
<a href="https://github.com/icub3d/joshua.themarshians.com">project on github</a>. It
works great for me, but I&rsquo;d be happy to entertain requests for
changes. I tried to keep it simple, so it expects you to design the
templates yourself but I imagine most DIY bloggers would want that
anyway. All I do now to publish is:</p>

<pre><code data-language="shell">$ goblog
$ appcfg.py update joshua.themarshians.com
</code></pre>

<p>Overall, it was a fun weekend for me and not just because of the
codeine. I can&rsquo;t say that I was a novice at Go, but I did learn a lot
and hope to use the project as a springboard for more learning. I
still need to add unit tests, improve the documentation, etc. All of
those are sure to increase my knowledge of Go.</p>


		
		<div class="tags">
			<ul>
				
				<li><a href="tags.html#go">go</a></li>
				
				<li><a href="tags.html#blog">blog</a></li>
				
				<li><a href="tags.html#html">html</a></li>
				
			</ul>
		</div>
		
	</div>
</div>
<hr>

<div class="row">
	<div class="span12">
		
		<h1>Go App, Do You Read Me?</h1>
		

		<p>
			<small id="entry-date">
				2013-01-17
			</small>
		</p>

		<!-- Title: Go App, Do You Read Me? -->

<!-- Author: Joshua Marsh -->

<!-- Tags: rpc,go,linux -->

<!-- Languages: shell,go -->

<p>I am now running a few personal <a href="http://golang.org/">Go</a> applications
and am working on a Go web application that will eventually be ready
for public consumption. Since Go gives us the ability to act as a
<a href="http://www.fastcgi.com/drupal/">FastCGI</a> backend or a
<a href="http://golang.org/pkg/net/http/">stand alone web application</a>, it
only seems reasonable that in a production system you&rsquo;d want the
ability to use it like any other web server. This includes the ability
to reload the configuration on the fly and start and stop the
application.</p>

<p>I thought I&rsquo;d put together an example of how I&rsquo;m doing it right
now. From what I&rsquo;ve been able to gather,
<a href="http://en.wikipedia.org/wiki/Remote_procedure_call">RPC</a> seems to be
the best way to interact with your application. If you are wanting to
run the application yourself, you can try it by doing:</p>

<pre><code data-language="shell">git clone https://github.com/icub3d/go-ipc-with-rpc.git
cd go-ipc-with-rpc/servicer
go install  
cd ../greeter  
go install  
cd ..  
emacs greeter.service
# Modify greeter.service to use the path to your GOBIN where the   
# above apps were installed.  
sudo cp greeter.services /etc/systemd/system  
cp config.json /tmp  
</code></pre>

<p>You can then run it and test if like so:</p>

<pre><code data-language="shell">$ sudo systemctl start greeter  
$ curl http://localhost:9000  
Howdy Doodie!  
$ emacs /tmp/config.json  
$ sudo systemctl reload greeter  
$ curl http://localhost:9000  
Hey there, partner!  
$ sudo systemctl stop greeter  
$ curl http://localhost:9000  
curl: (7) couldn't connect to host at localhost:9000  
</code></pre>

<p>At a high level there are three parts to the application. The first
part is the web application itself which can be found in the greeter
directory. The second is a helper application that makes RPC calls to
the greeter. It can be found in the servicer directory. Finally, we
have a default configuration for the greeter application and a systemd
service configuration file.</p>

<p>Within the greeter application, I&rsquo;ve divided the code into four
parts. The file
<a href="https://github.com/icub3d/go-ipc-with-rpc/blob/master/greeter/config.go">config.go</a>
manages reading the config file and translating it into a map that the
rest of the application can use. Using a <a href="http://www.json.org/">JSON</a>
config file makes reading and loading the configuration unbelievably
simple. I also use a <a href="http://golang.org/pkg/sync/#Mutex">mutex</a> to
protect access to the configuration while it is being reloaded.</p>

<p>The file
<a href="https://github.com/icub3d/go-ipc-with-rpc/blob/master/greeter/main.go">flag.go</a>
just initializes the command line flags for parsing. It isn&rsquo;t really
related to this post, but it was helpful during testing because I
could point to various configuration files. Under normal
circumstances, you&rsquo;d likely have more complex flags or maybe none at
all.</p>

<p>The file
<a href="https://github.com/icub3d/go-ipc-with-rpc/blob/master/greeter/main.go">main.go</a>
contains the main function which starts up the application. It first
parses the command line flags and then reads the configuration
file. It then starts the listener for our web application. Next, we
start the RPC services. We pass the web application&rsquo;s listener to this
function so that the RPC services know which listener to interact
with. Finally, we setup our web server.</p>

<p>The last file in the greeter application is
<a href="https://github.com/icub3d/go-ipc-with-rpc/blob/master/greeter/rpc.go">rpc.go</a>,
which is the meat of what I wanted to talk about. If this looks
foreign to you, don&rsquo;t fret. Go has some great <a href="http://golang.org/pkg/net/rpc/">documentation</a> on using
RPC. We create a ServiceHandler struct which will manage all of the
RPC calls. RPC requires a very specific method definition, so even
though we don&rsquo;t use the incoming arguments, they need to be present. I
used an integer for simplicity.</p>

<p>The Stop function checks to see if the listener is available and if so
closes it. This has the net effect of stopping the web application
because the <a href="http://golang.org/pkg/net/http/#Serve">http.Serve</a>
function exits when the listener is closed. The Reload function is
equally simple because we need only call the ReadConfig function
again.</p>

<p>The StartRPC function is what sets up the RPC service. You register
objects with the <a href="http://golang.org/pkg/net/rpc/">rpc</a> package and
then it takes care of determining which functions meet the criteria of
being exposed. In our case we register a ServiceHandler. We then set
up RPC to handle HTTP requests and open up a port to listen for those
request. Finally, we use the http&rsquo;s Serve function to start accepting
connections to the RPC service.</p>

<p>With that done, we now just need some way to talk to the RPC
service. I wrote a little helper application that does this in the
servicer directory. It is all contained in
<a href="https://github.com/icub3d/go-ipc-with-rpc/blob/master/servicer/servicer.go">servicer.go</a>. First,
it gets our operation from the command line and translates that into
the RPC method we want to call. Next, we create a client RPC
connection with the
<a href="http://golang.org/pkg/net/rpc/#DialHTTP">DialHTTP</a> function. We then
use the client to <a href="http://golang.org/pkg/net/rpc/#Client.Call">Call</a> the method we wanted.</p>

<p>Now all that remains is to hook it up into your service manager. I run
<a href="https://www.archlinux.org/">Arch Linux</a> and use <a href="http://www.freedesktop.org/wiki/Software/systemd">systemd</a>. If you run
another service manager, you&rsquo;ll have to set up your own configuration
for it. I&rsquo;ve provided a <a href="https://github.com/icub3d/go-ipc-with-rpc/blob/master/greeter.service">greeter.service</a> which starts up the greeter
application and uses the servicer to reload and stop the application.</p>

<p>Overall, I&rsquo;m extremely happy with the outcome. I can see this being a
common pattern and plan to eventually make a package out of it. If for
some reason all my links above weren&rsquo;t enough, here is where I got
most of my information from and my example:</p>

<ul>
<li><a href="http://golang.org/pkg/net/rpc/">Go&rsquo;s RPC Documentation</a></li>
<li><a href="http://www.freedesktop.org/software/systemd/man/systemd.service.html">Systemd&rsquo;s Service Configuration Options</a></li>
<li><a href="https://github.com/icub3d/go-ipc-with-rpc">My Completed Example</a></li>
</ul>

<h2>Updates</h2>

<p>There was some discussion about the security of using RPC. RPC itself
doesn&rsquo;t care about security so that can leave you open to
attack. Obviously a firewall would help solve this. Alternatively, you
can use a named pipe instead of a socket and go&rsquo;s rpc package will use
it just the same.</p>


		
		<div class="tags">
			<ul>
				
				<li><a href="tags.html#rpc">rpc</a></li>
				
				<li><a href="tags.html#go">go</a></li>
				
				<li><a href="tags.html#linux">linux</a></li>
				
			</ul>
		</div>
		
	</div>
</div>
<hr>

<div class="row">
	<div class="span12">
		
		<h1>Vim and Go</h1>
		

		<p>
			<small id="entry-date">
				2013-01-09 (Updated: 2013-01-28)
			</small>
		</p>

		<!-- Title: Vim and Go -->

<!-- Author: Joshua Marsh -->

<!-- Tags: vim,go -->

<!-- Languages: shell,go,html -->

<p>I grew up on <a href="http://www.gnu.org/software/emacs/">Emacs</a> and
<a href="http://www.gnu.org/software/bash/">Bash</a>. I love them dearly (I have
the pinky fingers to prove it). I&rsquo;m not so blinded by my faith in them
though that I won&rsquo;t occasionally try new things. I&rsquo;ve heard a lot of
good things about <a href="http://www.zsh.org/">Zsh</a> and I&rsquo;ve found myself
connecting to many a servers that have <a href="http://www.vim.org/">Vim</a>
installed but not Emacs. So, I thought I&rsquo;d give them a try.</p>

<p>Of course, my new pet programming language is
<a href="http://golang.org/">Go</a>, so I thought I&rsquo;d try and get some basic
functionality for Go working with Vim. I&rsquo;m pleased to say the process
was rather simple, but some of the documentation I found online was
somewhat outdated (the readmes were up to date but hard to find). I
thought I&rsquo;d share what I did, if nothing else so I can remember if I
ever have to do it again.</p>

<p>First, if you are like me and don&rsquo;t have Vim installed on your system,
you should get that setup. On
<a href="https://www.archlinux.org/">Arch Linux</a>, you can:</p>

<pre><code data-language="shell">sudo pacman -S gvim
</code></pre>

<p>This will install the GUI version of Vim as well as the console
version. Next, you&rsquo;ll want to update your <em>~/.vimrc</em> file to use Go&rsquo;s
Vim tools. They come standard with the installation, you just need to
setup Vim to use them. Append the following to your <em>~/.vimrc</em> file:</p>

<pre><code data-language="shell">set rtp+=$GOROOT/misc/vim
filetype plugin indent on
syntax on
</code></pre>

<p>You&rsquo;ll want to replace <em>$GOROOT</em> with the path to Go&rsquo;s share items (in
Arch Linux, it is <em>/usr/share/go</em>). This will give you fairly useful
features like syntax highlighting proper indentation, and
documentation.</p>

<p><img src="img/vim-godoc.png" alt="vim an godoc" />
</p>

<p>I was also interested in auto-completion as I use it quite often in
Emacs. Fortunately, <a href="https://github.com/nsf/gocode">Gocode</a> provides
functionality for vim as well. Setting it up was simple. If you
haven&rsquo;t used Gocode before, you&rsquo;ll need to install it&rsquo;s daemon:</p>

<pre><code data-language="shell">go get -u github.com/nsf/gocode
</code></pre>

<p>If you don&rsquo;t have your <em>$GOPATH*s bin folder in your path, you&rsquo;ll need
to add that. My *.zshrc</em> file has these lines that do just that:</p>

<pre><code data-language="shell">export GOPATH="${HOME}/go"
export GOBIN="${GOPATH}/bin"
export PATH="${PATH}:${GOBIN}"
</code></pre>

<p>With those steps completed, run the setup script provided:</p>

<pre><code data-language="shell">cd $GOPATH/src/github.com/nsf/gocode/vim
./update.bash
</code></pre>

<p>Finally, append the following to your <em>~/.vimrc</em>:</p>

<pre><code data-language="shell">filetype plugin on
</code></pre>

<p>Now, when you are typing a command and aren&rsquo;t quite sure what should
come next or want to see what the function parameters are, simply use
&lt;C-x&gt;&lt;C-o&gt; and Gocode will give you a list of possibly completion
commands. If you install packages, it will even auto-complete from
those (assuming they are in your <em>$GOPATH/pkg</em> directory).</p>

<p><img src="img/gocode.png" alt="gocode" />
</p>

<p>So far, I have been impressed with how Vim and Go interact. It was
fairly simple to setup considering I haven&rsquo;t ever used Vim except for
the most basic viewing and editing. I&rsquo;m not ready to leave Emacs just
yet, but Vim and Go have certainly been fun and I&rsquo;ll keep at it for a
while to see how close I can get to my keyboard-fu with Emacs.</p>

<p>If you have other cool things you are doing with Vim and Go that you
think would impress me, let me know! I&rsquo;m still new to Vim, so I&rsquo;d love
any feedback.</p>


		
		<div class="tags">
			<ul>
				
				<li><a href="tags.html#vim">vim</a></li>
				
				<li><a href="tags.html#go">go</a></li>
				
			</ul>
		</div>
		
	</div>
</div>
<hr>


<p><a href="archives.html">More...</a></p>


			<div class="centerad">
				<script type="text/javascript">
					if (window.innerWidth > 800) {
		google_ad_client = "ca-pub-5250935198625278";
		/* joshua.themarshians.com (normal) */
		google_ad_slot = "4997781473";
		google_ad_width = 728;
		google_ad_height = 90;
		} else {
		google_ad_client = "ca-pub-5250935198625278";
		/* joshua.themarshians.com (mobile) */
		google_ad_slot = "7951247872";
		google_ad_width = 320;
		google_ad_height = 50;
		}
</script>
<script type="text/javascript"
				src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
</div>
<footer>
	<p>
		<a rel="license" 
			 href="http://creativecommons.org/licenses/by/3.0/us/">
			<img alt="Creative Commons License" 
					 style="border-width:0" 
					 src="http://i.creativecommons.org/l/by/3.0/us/80x15.png" />
		</a>
		<br />
		This work is licensed under a 
		<a rel="license" 
			 href="http://creativecommons.org/licenses/by/3.0/us/">
			Creative Commons Attribution 3.0 United States License
		</a>.
	</p>
	<p>This site was generated with <a href="https://github.com/icub3d/goblog">goblog</a>.</p>
</footer>
</div>

<!-- These are the scripts for syntax highlighting. -->
<script 
	 src="//cdnjs.cloudflare.com/ajax/libs/rainbow/1.1.8/js/rainbow.min.js ">
</script>
<script src="rainbow/js/language/generic.js"></script>

<script src="rainbow/js/language/shell.js"></script>

<script src="rainbow/js/language/go.js"></script>

<script src="rainbow/js/language/html.js"></script>


<!-- Twitter Bootstrap. -->
<script src="//netdna.bootstrapcdn.com/twitter-bootstrap/2.2.2/js/bootstrap.min.js"></script>

<!-- Google Analytics. -->
<script type="text/javascript">

	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-37698200-1']);
	_gaq.push(['_trackPageview']);

	(function() {
	var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();

</script>
</body>
</html>
